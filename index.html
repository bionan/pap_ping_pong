<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #jogo {
            background-color: black;
        }
    </style>
</head>
<body>
    <canvas id="jogo" width="600" height="480"></canvas>
    <script>

        //
        // AS FUNÇÕES FICAM AQUI
        //
        function teclaPressionada(e) {
            //console.log(e.code);
            switch( e.code ) {

                // Verificar se a tecla ArrowRight (SetaDireita) foi pressionada
                // Se sim, atribuir o valor true a variável tecla_dir
                case 'ArrowRight':
                    tecla_dir = true;
                    break;

                // Verificar se a tecla D (qual será o código da tecla D?) foi pressionada
                // Se sim, atribuir o valor true a variável tecla_d                    
                //
                // ESCREVA O CÓDIGO NAS LINHAS SEGUINTES
                case 'KeyD' :
                    tecla_d = true;
                    break;

                // Verificar se a tecla ArrowLeft (SetaEsquerda) foi pressionada
                // Se sim, atribuir o valor true a variável tecla_esq
                case 'ArrowLeft':
                    tecla_esq = true;
                    break;

                // Verificar se a tecla A (qual será o código da tecla A?) foi pressionada
                // Se sim, atribuir o valor true a variável tecla_a
                //
                // ESCREVA O CÓDIGO NAS LINHAS SEGUINTES
                case 'KeyA' :
                    tecla_a = true;
                    break;

                // Verificar se a tecla ArrowUp (SetaCima) foi pressionada
                // Se sim, atribuir o valor true a variável tecla_cima               
                case 'ArrowUp':
                    tecla_cima = true;
                    break;

                // Verificar se a tecla W (qual será o código da tecla W?) foi pressionada
                // Se sim, atribuir o valor true a variável tecla_w
                //
                // ESCREVA O CÓDIGO NAS LINHAS SEGUINTES  
                case 'KeyW' : 
                    tecla_w = true;
                    break;                 

                // Verificar se a tecla ArrowDown (SetaBaixo) foi pressionada
                // Se sim, atribuir o valor true a variável tecla_baixo        
                case 'ArrowDown':
                    tecla_baixo = true;
                    break;

                // Verificar se a tecla S (qual será o código da tecla S?) foi pressionada
                // Se sim, atribuir o valor true a variável tecla_s
                //
                // ESCREVA O CÓDIGO NAS LINHAS SEGUINTES    
                case 'KeyS' :
                    tecla_s = true;
                    break;   
            }
            move();
        }

        function teclaLiberada(e) {
            //console.log(e);
            switch( e.code ) {

                // Verificar se tecla ArrowRight libertada
                // Se sim atribuir false a tecla_dir
                case 'ArrowRight':
                    tecla_dir = false;
                    break;

                // Verificar se tecla D libertada
                // Se sim atribuir false a variável tecla_d                  
                //
                // ESCREVA O CÓDIGO NAS LINHAS SEGUINTES   
                case 'KeyD' :
                    tecla_d = false;
                    break; 

                case 'ArrowLeft':
                    tecla_esq = false;
                    break;

                // Verificar se tecla A libertada
                // Se sim atribuir false a variável tecla_a                 
                //
                // ESCREVA O CÓDIGO NAS LINHAS SEGUINTES    
                case 'KeyA' :
                    tecla_a = false;
                    break;


                case 'ArrowUp':
                    tecla_cima = false;
                    break;

                // Verificar se tecla W libertada
                // Se sim atribuir false a variável tecla_w                 
                //
                // ESCREVA O CÓDIGO NAS LINHAS SEGUINTES   
                case 'KeyW' :
                    tecla_w = false;
                    break;                    


                case 'ArrowDown':
                    tecla_baixo = false;
                    break;

                // Verificar se tecla S libertada
                // Se sim atribuir false a variável tecla_s                
                //
                // ESCREVA O CÓDIGO NAS LINHAS SEGUINTES    
                case 'KeyS' :
                    tecla_s = false;
                    break;

            }
        }

        function desenha() {

            // Limpar o canvas (tela do jogo)
            jogo.clearRect(0,0,600,480);

            // mover os objetos
            move();

            // testar colisao
            checarColisao(raquete1,raquete2);
            
            //mostrador = "PosX: " + raquete.x + " PosY: " + raquete.y;
            //canvas.fillStyle = "red";
            //canvas.font = "24px serif";
            //canvas.textAlign = "center";
            //canvas.fillText(mostrador,300,30);
            
            // Desenhar a com a cor vermelho
            // a raquete1 com 10px de largura e 50px de altura
            jogo.beginPath();
            jogo.fillStyle = "red";
            jogo.rect(raquete1.x, raquete1.y, raquete1.larg, raquete1.alt);
            jogo.fill();

            // Desenhar a com a cor vermelho
            // a raquete2 com 10px de largura e 50px de altura
            //
            // ESCREVA O CÓDIGO NAS LINHAS SEGUINTES  
            jogo.beginPath();
            jogo.fillStyle = "blue";
            jogo.rect(raquete2.x, raquete2.y, raquete2.larg, raquete2.alt);
            jogo.fill();

            // Desenhar a bola
            jogo.beginPath();
            jogo.fillStyle = "white";
            jogo.rect(bola.x, bola.y, bola.larg, bola.alt);
            jogo.fill();

            requestAnimationFrame(desenha);
            
        }

        function move() {

            // Verifica se o valor da variável tecla_dir é true
            // o que indica que a raquete1 deve se mover para a direita
            // um número de pixeis indicado pela sua velocidade 
            if ( tecla_dir == true ) {

                raquete1.x += raquete1.vel;
                
                if ( raquete1.x + raquete2.larg > canvas.width ) {
                    raquete1.x -= raquete1.vel;
                }

            // Se não verificar se o valor da variável tecla_esq é true
            // o que indica que a raquete1 deve se mover para a esquerda
            // um número de pixeis indicado pela sua velocidade                 
            } else if ( tecla_esq == true ) {

                raquete1.x -= raquete1.vel;

                if ( raquete1.x < 0 ) {
                    raquete1.x = 0;
                }
            }

            // Verifica se o valor da variável tecla_cima é true
            // o que indica que a raquete1 deve se mover para cima
            // um número de pixeis indicado pela sua velocidade             
            if ( tecla_cima == true ) {
                raquete1.y -= raquete1.vel;

                // raquete ultrapassou o limite superior? (y < 0)
                if ( raquete1.y < 0 ) {
                    raquete1.y = 0;
                }

            // Se não verificar se o valor da variável tecla_baixo é true
            // o que indica que a raquete1 deve se mover para baixo
            // um número de pixeis indicado pela sua velocidade                     
            } else if ( tecla_baixo == true ) {
                raquete1.y += raquete1.vel;

                // raquete ultrapassou o limite inferior? ( y + altura > altura do canvas
                if ( raquete1.y + raquete1.alt > canvas.height ) {
                    raquete1.y -= raquete1.vel;
                }
            }

            // Fazer os mesmos testes para as variáveis tecla_a, tecla_d
            // tecla_w e tecla_s atualizando a posição da raquete2
            //
            // ESCREVA O CÓDIGO NAS LINHAS SEGUINTES 
            if ( tecla_d == true) {
                raquete2.x += raquete2.vel;

                if ( raquete2.x + raquete2.larg > canvas.width ) {
                    raquete2.x -= raquete2.vel;
                }

            } else if ( tecla_a == true) {
                
                raquete2.x -= raquete2.vel;

                if ( raquete2.x < 0 ) {
                    raquete2.x = 0;
                }
            } 
            
            if ( tecla_w == true) {

                raquete2.y -= raquete2.vel;

                if (raquete2.y < 0 ) {
                    raquete2.y = 0;
                }

            } else if ( tecla_s == true) {
                
                raquete2.y += raquete2.vel;

                if ( raquete2.y + raquete2.alt > canvas.height ) {
                    raquete2.y  -= raquete2.vel;
                }
            }

            bola.x += bola.velx;
            bola.y += bola.vely;

            // verificar se bola sai fora dos limites do canvas
            if ( bola.x < 0 || bola.x > canvas.width ) {
                bola.velx = -bola.velx;
            }
            if ( bola.y > canvas.height || bola.y < 0 ) {
                bola.vely = -bola.vely;
            }
            
        }


        //
        // Retorna true se há colisão e false caso não haja colisão
        //
        function checarColisao(obj1, obj2) {

            var colisaoX = obj1.x + obj1.larg > obj2.x && obj1.x < obj2.x + obj2.larg;
            var colisaoY = obj1.y + obj1.alt > obj2.y && obj1.y < obj2.y + obj2.alt;

            return colisaoX && colisaoY;
        }
      


        var canvas = document.getElementById("jogo");
        var jogo = canvas.getContext("2d");

        // criar o objeto raquete1 incialmente na posição x = 50
        // y = 50 e velocidade 10px
        var raquete1 = {x:50, y:50, alt:100, larg:55, vel:10};

        // criar o objeto raquete2 incialmente na posição x = 150
        // y = 150 e velocidade 10px 
        // ESCREVA O CÓDIGO NAS LINHAS SEGUINTES
        var raquete2 = {x:150, y:150, alt:100, larg:55, vel:10};

        // Criar a bola
        //
        var bola = { x: canvas.width/2, y:canvas.height/2, alt:10, larg:10, velx:5, vely:-5 };

        // Criar as variáveis tecla_dir, tecla_esq, tecla_cima, tecla_baixo
        // inicialmente todas com valores false
        var tecla_dir = false;
        var tecla_esq = false;
        var tecla_cima = false;
        var tecla_baixo = false;

        // Criar as variáveis tecla_d, tecla_a, tecla_w, tecla_s
        // inicialmente todas com valores false
        //
        // ESCREVA O CÓDIGO NAS LINHAS SEGUINTES
        var tecla_d = false;
        var tecla_a = false;
        var tecla_w = false;
        var tecla_s = false;

        document.addEventListener('keydown', teclaPressionada);

        document.addEventListener('keyup', teclaLiberada);

        desenha();


    </script>
</body>
</html>